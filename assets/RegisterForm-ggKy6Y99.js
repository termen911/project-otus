import{r as b,I as M,_ as R,b as j,c as w,a as y,A as S,u as v,d as C,j as s,B as F,T as I}from"./index-CHNgfYCQ.js";import{u as k,F as o,I as a,D as L,h as P,s as T}from"./handleApiError-Di8xC1Pk.js";import{R as h}from"./LockOutlined-2kBE6tH8.js";var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},z=function(e,t){return b.createElement(M,R({},e,{ref:t,icon:D}))},q=b.forwardRef(z);const A={signin:r=>j.post("/signin",r),signup:r=>j.post("/signup",r)},B=()=>{const{setToken:r}=w();return k({mutationFn:A.signin,onSuccess:({data:e})=>{r(e.token)},onError:e=>{console.error(e)}})},{Item:p}=o,{Link:N}=I,Q=()=>{const[r]=o.useForm(),{t:e}=y("features.auth.auth-by-email"),{message:t}=S.useApp(),{mutate:l,isPending:n}=B(),m=v(),c=C(),u=i=>{const g={email:i.email,password:i.password};l(g,{onSuccess:()=>{t.success(e("login.success")),c.clear(),m("/profile")},onError:E=>{const x=P(E);x.length>0&&r.setFields(x.map(f=>({name:f.fieldName,errors:[f.message]})))}})};return s.jsxs(o,{form:r,name:"login",layout:"vertical",onFinish:u,disabled:n,autoComplete:"off",style:{maxWidth:400,margin:"0 auto",padding:"20px"},children:[s.jsx("h2",{style:{textAlign:"center",marginBottom:24},children:e("login.title")}),s.jsx(p,{name:"email",label:e("login.email.label"),rules:[{required:!0,message:e("login.email.required")},{type:"email",message:e("login.email.invalid")}],children:s.jsx(a,{"data-testid":"email-input",prefix:s.jsx(q,{}),placeholder:e("login.email.placeholder"),autoFocus:!0})}),s.jsx(p,{name:"password",label:e("login.password.label"),rules:[{required:!0,message:e("login.password.required")},{min:6,message:e("login.password.minLength")}],children:s.jsx(a.Password,{"data-testid":"password-input",prefix:s.jsx(h,{}),placeholder:e("login.password.placeholder")})}),s.jsx(p,{children:s.jsx(F,{type:"primary",htmlType:"submit",loading:n,block:!0,children:e(n?"login.submitLoading":"login.submit")})}),s.jsx(L,{style:{margin:"24px 0"}}),s.jsxs("div",{style:{textAlign:"center",fontSize:"0.95rem"},children:[e("login.signupDescription")," ",s.jsx(N,{onClick:()=>m("/auth/signup"),children:e("login.links.signup")})]})]})},O=()=>{const{setToken:r}=w();return k({mutationFn:async e=>(await A.signup(e)).data,onSuccess:e=>{r(e.token)},onError:e=>{console.error(e)}})},{Item:d}=o,{Link:V}=I,_="1234567890",G=()=>{const[r]=o.useForm(),{t:e}=y("features.auth.auth-by-email"),{mutate:t,isPending:l}=O(),n=v(),m=c=>{t(c,{onSuccess:()=>{T.success(e("register.success")),n("/profile")},onError:u=>{const i=P(u);i.length>0&&r.setFields(i.map(g=>({name:g.fieldName,errors:[g.message]})))}})};return s.jsxs(o,{form:r,name:"register",layout:"vertical",onFinish:m,disabled:l,autoComplete:"off",style:{maxWidth:400,margin:"0 auto",padding:"20px"},initialValues:{commandId:_},children:[s.jsx("h2",{style:{textAlign:"center",marginBottom:24},children:e("register.title")}),s.jsx(d,{name:"commandId",label:e("register.label"),hidden:!0,children:s.jsx(a,{disabled:!0})}),s.jsx(d,{name:"email",label:e("register.email.label"),rules:[{required:!0,message:e("register.email.required")},{type:"email",message:e("register.email.invalid")}],children:s.jsx(a,{prefix:s.jsx(q,{}),placeholder:e("register.email.placeholder"),autoFocus:!0})}),s.jsx(d,{name:"password",label:e("register.password.label"),rules:[{required:!0,message:e("register.password.required")},{min:6,message:e("register.password.minLength")}],children:s.jsx(a.Password,{prefix:s.jsx(h,{}),placeholder:e("register.password.placeholder")})}),s.jsx(d,{name:"confirmPassword",label:e("register.confirmPassword.label"),dependencies:["password"],rules:[{required:!0,message:e("register.confirmPassword.required")},({getFieldValue:c})=>({validator(u,i){return!i||c("password")===i?Promise.resolve():Promise.reject(new Error(e("register.confirmPassword.mismatch")))}})],children:s.jsx(a.Password,{prefix:s.jsx(h,{}),placeholder:e("register.confirmPassword.placeholder")})}),s.jsx(d,{children:s.jsx(F,{type:"primary",htmlType:"submit",loading:l,block:!0,children:e(l?"register.submitLoading":"register.submit")})}),s.jsx(L,{style:{margin:"24px 0"}}),s.jsxs("div",{style:{textAlign:"center",fontSize:"0.95rem"},children:[e("register.signinDescription")," ",s.jsx(V,{onClick:()=>n("/auth/signin"),children:e("register.links.signin")})]})]})};export{Q as L,G as R};
